
require('dotenv').config();
const express = require('express');
const { GoogleGenerativeAI } = require('@google/generative-ai');

const app = express();
const port = 3000;

// Express 앱이 JSON 요청 본문을 파싱하고, 정적 파일을 제공하도록 설정합니다.
app.use(express.json());
app.use(express.static('.')); // 현재 디렉토리의 파일들(index.html 등)을 제공합니다.

// Gemini API 클라이언트를 초기화합니다.
const genAI = new GoogleGenerativeAI(process.env.GEMINI_API_KEY);

// 화원중학교에 대한 기본 정보를 변수로 저장합니다.
const hwawonInfo = `
- 학교명: 화원중학교 (花園中學校, Hwawon Middle School)
- 주소: 대구광역시 달성군 화원읍 성암로 48 (본리리)
- 개교: 2000년 03월 01일
- 유형: 공립 남녀공학 중학교
- 교장: 노홍인 (2025년 기준 제13대)
- 교감: 김선희
- 교훈: 바르게 살자
- 상징:
  - 교목: 느티나무 (의미: '화합과 통일', '무궁한 번영과 발전', '선진국으로서의 기상'을 상징하고, 역사성과 문화성을 지니고 있음)
  - 교화: 장미 (의미: 내한성이 강한 관목성 꽃나무로서 꽃이 아름답고 색채가 다양하며, 사랑이 넘치고 정열과 진취성 및 강인한 끈기를 나타내며, '밝고 아름다운 진취적 기상'을 상징함)
- 학생 수: 293명 (2025년 3월 기준)
- 교직원 수: 49명 (2025년 3월 기준)
- 관할 교육청: 대구광역시달성교육지원청
- 홈페이지: [화원중학교 홈페이지](https://hw.dge.ms.kr/hwm/main.do)
- 주소 : (우)42966 대구광역시 달성군 화원읍 성암로 48 (본리리 104-2번지)
- 선생님들
  -이승자(수학선생님, 교사, 교무기획부장)
  -강혜미(기술선생님, 교사, 교육연구부장)
  -하태은(체육선생님, 교사, 생활안전부장)
  -장혜진(영어선생님, 교사, 학력향상부장)
  -정태인(체육선생님, 교사, 체육예술부장)
  -김승희(진로선생님, 교사, 진로진학부장)
  -이순영(지리선생님, 교사, 인성인문부장, 3학년 4반)
  -이근희(가정선생님, 교사, 학부모인문부장, 1학년 3반)
  -황*영(물리선생님, 교사, 과학영재부장, 3학년 3반)
  -신원욱(미술선생님, 교사, 정보환경부장, 1학년 4반)
  -박명수(도덕선생님, 교사, 1학년부장, 1학년 1반)
  -이은(영어선생님, 교사, 1학년 2반)
  -전영숙(국어선생님, 교사, 2학년부장, 2학년 1반)
  -김정은(수학선생님, 교사, 2학년 2반)
  -이동우(과학선생님, 교사, 2학년 3반)
  -김미라(음악선생님, 교사, 2학년 4반)
  -이효정(국어선생님, 교사, 3학년 1반)
  -장미향(중국어/한문선생님, 교사, 3학년 2반)
  -구미현(국어선생님, 교사)
  -조형주(역사선생님, 교사)
  -배활기찬(정보선생님, 교사)
  -손*길(수학선생님, 교사)
  -이재욱(과학선생님, 교사)
  -김윤정(영어선생님, 교사)
  -엄현주(기술선생님, 교사)
  -정*희(보건선생님, 교사)
  -홍정임(상담선생님, 교사)
  -김*아(영양사선생님, 교사)
  -이*주(사서선생님, 교사)
  -Jone Purchell[존 퍼쉘, 잭 티쳐](영어, 원어민 영어보조교사)
교무실 : (053) 235-3339
3학년실 : (053) 235-3373
행정실 : (053) 235-3335
팩스 : (053) 636-3401

- 학교 연혁:
  - 2000-03-01: 초대 배중웅 교장 취임
  - 2000-03-03: 제1회 입학식 (8학급, 272명)
  - 2001-05-06: 학교교육계획서 우수학교 선정 (교육감)
  - 2003-02-12: 제1회 졸업식 (312명)
  - 2005-12-20: 전국 100대 교육과정 최우수학교 선정 (교육인적자원부장관)
  - 2007-12-27: 학교평가 최우수상 수상 (교육감)
  - 2011-12-19: 전국 100대 교육과정 최우수학교 재선정 (교육과학기술부 장관)
  - 2012-05-28: 제41회 전국소년체전 태권도 금메달 1, 동메달 1 수상
  - 2013-05-27: 제42회 전국소년체전 태권도 금메달 2개 획득
  - 2014-01-15: 2013학년도 학교평가 최우수 선정 (교육감)
  - 2016-09-24: 대구광역시교육감배 줄넘기 대회 우승 (3연패)
  - 2017-03-01: 제9대 남정순 교장 취임
  - 2020-03-01: 제10대 장석두 교장 취임
  - 2021-09-01: 제11대 김현순 교장 취임
  - 2024-03-01: 제12대 신재건 교장 취임
  - 2024-03-04: 제25회 입학식 (107명)
  - 2025-03-01: 제13대 노홍인 교장 취임
  - 2025-03-04: 제26회 입학식 (106명)

- 교가:
  (1절) 비슬산 봉우리에 떠-오른 태양
  찬란한 그 햇살을 가슴에 안고
  세계로 미래로 뻗어 나-가-는
  희망의 은빛날개 더욱 빛난다
  (후렴) 올려라 푸른깇발 새역사 앞에
  힘차게 전진한다 화원중학교

- 이용 가능한 대중교통 (버스):
  - 화동초등학교앞 정류장: 달서3
  - 화동초등학교건너 정류장: 달서3
  - 새터건너 정류장: 달성2 (본리2리 방향)
  - 새터앞 정류장: 달성2 (본리2리 방향)
  - 본리지구앞 정류장: 623, 653, 달서3
  - 본리지구건너 정류장: 623, 653, 달서3, 달성1

- 학생 인원수(고급)
  - 학년	|학급수	|남	    |여	    |계
    1학년	|4	    |58	    |47	    |106
    2학년	|4(1)	|63(2)	|42(1)	|105(3)
    3학년	|4	    |33(1)	|50(1)	|83(2)
    총계	|12(1)	|154(3)	|139(2)	|293(5)

- 학교운영위원회규정
  -제1장 총 칙
제1조(목적)
이 규정은 초·중등교육법 제31조 내지 제34조, 같은법 시행령 제58조 내지 제60조 및 제64조, 대구광역시 공립 유치원 및 학교 운영위원회 설치 및 운영에 관한 조례의 규정에 의하여 화원중학교운영위원회(이하 “운영위원회”라 한다)의 구성· 운영등에 관한 사항을 규정함을 목적으로 한다.

제2장 운영위원회 구성
제2조(위원의 정수)
01운영위원회 위원(이하 “위원‘이라 한다)은 9인으로 하되, 학부모위원 4인(44%),학교장을 포함한 교원위원 3인(33%), 지역위원 2인(22%)으로 한다.
02초·중등교육법시행령 제58조 제1항의 규정에 의한 학생수 기준일은 매년 3월 1일로 한다.
제3조(위원의 선출시기)
01학부모위원 및 교원위원은 임기만료일 10일 이전에, 지역위원은 임기만료일 전일까지 선출한다.
02위원의 결원된 때에는 보궐 선출한다. 다만, 잔여임기가 6월 미만으로 위원 정수의 4분의 1이상이 결원 되지 아니한 때에는 운영위원회의 결정으로 선출하지 아니할 수 있다.
제4조(선출관리위원회)
01학부모위원과 교원위원의 선출을 관리하기 위하여 선출관리위원회를 각각 구성한다.
02선출관리위원회는 위원의 후보자 등록, 투·개표, 당선자 공고 등의 사무를 관장하며 구성시부터 위원 선출이 종료될 때까지 운영된다.
03학부모위원 선출관리위원회는 교직원 3인, 학년별 학부모 2인으로 구성하되, 학교장이 위촉하며 위원장은 호선한다.
04교원위원 선출관리위원회는 교직원 전체회의의 추천을 받은 교직원 3인으로 구성하되 위원장은 호선한다.
05선출관리위원은 위원으로 입후보하지 않는 학부모 및 교직원으로 구성한다.
06제1항부터 제5항까지의 규정에도 불구하고 천재·지변, 감염병 확산, 그 밖에 불가항력의 사유로 휴업 명령 등이 내려진 경우에는 최소한의 범위에서 선출관리 업무 일부를 조정하여 운영할 수 있다.
제5조(학부모위원의 선출)
01학부모위원은 학부모 전체회의에서 직접 선출한다. 다만, 학교의 규모·시설 등을 고려하여 학부모 전체회의에서 선출하기 곤란한 사유가 있는 경우 학급별 대표로 구성된 학부모 대표회의에서 선출할 수 있다.
02학부모위원 선출관리위원회는 선거일 10일전까지 위원선출에 대한 공고를 하여야 한다.
03입후보자는 선거일 7일전까지 학부모위원 선출관리위원회에 등록하여야 한다.
04학부모는 선거 당일에 후보자의 소견 발표를 들은 후 투표한다.
05개표결과 다수 득표자순으로 당선자를 결정한다. 다만, 득표수가 같은 학부모위원 후보자가 2인 이상 있는 때에는 연장자 순으로 결정한다.
06선거 결과는 학교게시판에 게시(또는 가정통신문 발송)한다.
07학부모위원 선출 및 임기는 제3조 및 제8조의 규정에 따른다.
08제7항의 규정에도 불구하고, 천재·지변, 그 밖에 불가항력의 사유로 휴업 명령 등이 내려져 전체회의 개최가 불가능하다고 판단되는 경우에는 임기 만료일 또는 휴업 등 종료일 이후 10일 이내까지 선출할 수 있다.
09제8항에 따라 선출된 위원은 제8조의 규정에도 불구하고 당선자 공고일을 임기 개시일로 하며, 전임 위원의 임기 만료일 다음 날부터 2년이 되는 날을 임기 만료일로 한다.
10제2항부터 제6항까지의 규정에도 불구하고 천재·지변, 그 밖에 불가항력의 사유로 휴업 명령 등이 내려진 경우에는 최소한의 범위에서 일정 축소, 온라인 활용 등 선출업무 일부를 조정하여 운영할 수 있다.
11투표는 단기명식 무기명투표로 한다. 다만, 학부모위원 선출시 학부모 전체회의에 직접 참가할 수 없는 학부모는 학부모 전체회의 개최 전까지 가정통신문에 대한 회신, 우편투표, 전자적 방법(「전자문서 및 전자거래 기본법」제2조제2호에 따른 정보처리시스템을 사용하거나 그 밖에 정보통신기술을 이용하는 방법을 말한다)에 의한 방법 및 절차에 따라 후보자에게 투표할 수 있다.
12제11항에 따른 구체적인 선출 방법은 선출관리위원회에서 의결로 결정한다.
제6조(교원위원의 선출)
01당연직 교원위원인 학교장을 제외한 교원위원은 교직원 전체회의에서 무기명투표로 선출한다.
02교원위원 선출관리위원회는 선거일 10일전까지 위원 선출에 대한 공고를 하여야 한다.
03입후보자는 선거일 7일전까지 본교 교원 2인 이상의 추천을 받아 교원위원 선출관리위원회에 등록하여야 한다.
04교직원은 선거당일에 후보자의 소견 발표를 들은 후 투표한다.
05개표결과 다수 득표자순으로 당선자를 결정한다. 다만, 득표자수가 같은 교원위원 후보자가 2인이 있는 때에는 연장자순에 의하여 결정한다.
06교원위원 선출 및 임기는 제3조 및 제8조의 규정에 따른다.
07제6항의 규정에도 불구하고 천재·지변, 그 밖에 불가항력의 사유로 전체회의 개최가 불가하다고 판단되는 경우에는 임기 만료일 또는 휴업 등 종료일 이후 10일 이내까지 선출할 수 있다.
08제7항에 따라 선출된 위원은 제8조의 규정에도 불구하고 당선자 공고일을 임기 개시일로 하며, 전임 위원의 임기 만료일 다음 날부터 2년이 되는 날을 임기 만료일로 한다.
09제2항부터 제5항까지의 규정에도 불구하고 천재·지변, 그 밖에 불가항력의 사유로 휴업 명령등이 내려진 경우에는 최소한의 범위에서 일정 축소, 온라인 활용 등 선출업무 일부를 조정하여 운영할 수 있다.
제7조(지역위원의 선출)
01지역위원은 학부모위원 또는 교원위원의 추천을 받아 학부모위원 및 교원위원이 무기명투표로 선출한다.
02지역위원 선출 및 임기는 제3조 및 제8조의 규정에 따른다.
03제2항의 규정에도 불구하고 천재·지변, 그 밖에 불가항력의 사유로 전체회의 개최가 불가능하다고 판단되는 경우에는 임기만료일 또는 휴업 등 종료일 이후 15일 이내까지 선출할 수 있다.
04제3항에 따라 선출된 위원은 제8조의 규정에도 불구하고 당선자 공고일을 임기 개시일로 하며, 전임 위원의 임기 만료일 다음 날부터 2년이 되는 날을 임기 만료일로 한다.
제8조(위원의 임기)
01위원의 임기는 2년으로 하며, 1차에 한하여 연임할 수 있다. 다만, 보궐위원의 임기는 전임자의 잔임기간으로 한다.
02위원의 임기 개시일은 4월 1일로 한다.
제9조(위원의 자격)
01학부모위원 및 지역위원은 국가공무원법 제33조의 공무원 결격사유에 해당하지 아니하여야 한다.
02학부모위원은 선출일 현재 본교에 재학하는 학생의 보호자로, 교원위원 본교에 재직중인 자로 한다.
03지역위원은 본교가 소재하는 지역을 생활근거지로 하는 자로서 교육행정에 관한 업무를 수행하는 공무원, 본교가 소재하는 지역을 사업활동의 근거지로 하는 사업자, 본교를 졸업한 자, 기타 본교 운영에 이바지하고자 하는 자로 한다.
04위원은 다른 학교의 위원을 겸할 수 없다. 다만, 당연직으로 위원이 될 경우에는 그러하지 아니하다.
제10조(위원의 의무 등)
01위원은 무보수 봉사직으로 하며, 수당을 지급하지 아니한다.
02위원은 운영위원회 회의에 성실히 참여하여야 하며, 운영위원회를 통하지 아니하고는 학교운영에 관여할 수 없다.
03위원은 본교와 영리를 목적으로 하는 거래를 하거나 그 지위를 남용하여 재산상의 권리·이익의 취득 또는 알선을 하여서는 아니 된다.
04학부모위원에게는 일반 학부모보다 비용부담을 가중시키지 않음을 원칙으로 한다.
제11조(위원의 퇴직)
01학생의 졸업, 전학 및 퇴학, 교원의 전보 및 특별한 사유없이 3회 연속 회의에 불참한 때에는 그 위원은 당연퇴직한다.
02학부모위원 선출 과정시 본인이 제출한 신상자료, 학력, 경력 등의 주요내용에 허위사실이 있는 것이 발견된 때에는 운영위원회의 결정으로 그 위원의 자격을 박탈할 수 있다.
제12조(위원장의 임기 등)
01운영위원회에는 위원장 및 부위원장 각 1인을 두되, 교원위원이 아닌 위원 중에서 선출한다.
02위원장과 부위원장의 임기는 1년으로 하며, 1차에 한하여 연임 할 수 있다.
03위원장과 부위원장은 무기명투표로 선출하되 재적위원 과반수의 득표로 당선된다. 다만, 재적위원 과반수의 득표자가 없을 때에는 2차 투표를 하여 최고 득표자를 당선자로 한다. 이 경우 최고 득표자가 2인 이상인 경우에는 연장자를 당선자로 한다.
04위원장과 부위원장은 운영위원회의 동의를 얻어 그 직을 사임할 수 있다.
05위원장은 운영위원회를 대표하고 회의를 소집하여 진행하며, 부위원장은 위원장이 사고가 있을 때에 그 직무를 대행한다.
06위원장 또는 부위원장이 임기 중에 궐위된 때에는 보궐선출할 수 있으며, 그 임기는 전임자의 잔임기간으로 한다.
제13조(소위원회 등의 설치)
01운영위원회는 안건 심사의 효율화를 기하기 위하여 예산·결산, 교육과정운영, 사회교육, 학교급식, 학교교육분쟁조정 소위원회 등을 둘 수 있다.
02소위원회 위원수 및 위원은 운영위원회의 의결로 정하되, 위원수는 운영위원회 재적위원 2분의 1을 넘지 못한다.
03소위원회가 안건의 심사를 마친 때에는 심사결과를 서면으로 운영위원회에 보고하여야 한다. 단, 학교교육분쟁 소위원회의 경우 소위원회에서 비공개로 결정한 사항은 보고하지 아니할 수 있다.
04소위원회의 운영 등에 관하여 이 조에서 정한 것 이외의 사항에 대하여는 운영위원회에 관한 규정을 준용할 수 있다.
제14조(학교내의 자생조직)
01학부모 등으로 구성되는 학교 내의 자생조직은 자율적으로 운영한다(또는 운영위원회의 산하단체로 둔다)
02자생조직의 대표자는 그 조직의 활동과 관련하여 운영위원회의 허가를 얻어 회의에 출석·발언할 수 있다.
제3장 운영위원회 기능
제15조(기능)
01운영위원회는 다음 각 호의 사항을 심의한다.
1. 학교헌장 및 학칙의 제정 또는 개정에 관한 사항
2. 학교의 예산안 및 결산에 관한 사항
3. 학교교육과정의 운영방법에 관한 사항
4. 교과용도서 및 교육자료의 선정에 관한 사항
5. 정규학습시간 종료 후 또는 방학기간중의 교육활동 및 수련활동에 관한 사항
6. 교육공무원법 제31조 제2항의 규정에 의한 초빙교원의 추천에 관한 사항
7. 학교운영지원비 조성·운용 및 사용에 관한 사항
8. 학교급식에 관한 사항
9. 학교운동부의 구성·운영에 관한 사항
10. 학교운영에 대한 제안 및 건의사항
11. 초·중등교육법시행령 제42조제2항의 규정에 의한 산학 겸임교사, 명예교사 및 강사의 임용에 관한 사항
12. 학생지도를 위한 지원 사항
13. 교복 및 체육복의 선정, 수학여행 등 학부모가 경비를 부담하는 사항(다만, 특정서클 등에서 특정학생을 대상으로 하는 사항은 제외)
14. 지역사회교육에 관한 사항
15. 학부모 및 일반인을 대상으로 하는 평생 교육프로그램의 설치·운영에 관한 사항
16. 학교교육분쟁조정위원회의 설치 및 운영에 관한 사항
17. 기타 학교장이 심의 요청한 사항
02운영위원회는 학교발전기금의 조성·운용 및 사용에 관한 사항을 심의·의결한다.
제16조(심의결과의 통보)
운영위원회위원장은 제15조의 규정에 의한 심의결과를 문서로 작성하여 지체없이 학교장에게 이송하여야 한다.

제17조(건의절차 등)
01제15조 제1항 제11호의 규정에 의하여 운영위원회에 건의를 하고자하는 자는 건의서에 주소·성명 등을 기재하고 서명한 후, 위원 1인 이상의 소개를 얻어 건의서를 제출하여야 한다.
02건의를 소개한 위원은 운영위원회의 요구가 있을 때에는 건의의 취지를 설명하여야 한다.
03위원장은 운영위원회에서 심의하여 채택한 건의 중 학교장의 권한에 관한 사항은 운영위원회의 의견서를 첨부하여 학교장에게 이송하고 학교장은 그 처리결과를 운영위원회에 보고하여야 한다.
04위원장은 건의의 처리 결과를 건의인에게 서면으로 통지하여야 한다.
제18조(서류 제출 요구)
01운영위원회는 그 의결로 안건의 심의와 직접 관련된 서류의 제출을 학교장에게 요구할 수 있다.
제4장 운영위원회 운영
제19조(회의소집 등)
01회의는 정기회와 임시회로 구분하여 운영하며, 정기회는 매년 9월 20일에 소집한다. 다만, 정기회 개최일이 공휴일인 때에는 그 다음날 소집한다.
02위원 선출후 최초로 소집되는 임시회는 학교장이 위원 임기 개시일부터 15일 이내에 소집한다.
03임시회는 학교장 또는 재적위원 3분의 1이상의 요구가 있을 때에는 위원장이 소집한다.
04회의는 개최 예정일 7일전에 소집공고와 함께 회의 안건을 첨부하여 위원에게 개별 통지한다. 다만, 위원장이 긴급을 요하는 안건이라고 인정할 경우에는 그러하지 아니한다.
05정기회 회기는 2일 이내, 임시회의 회기는 1일 이내로 하되, 회의는 연 3회 이상 개최하여야 한다.
06위원회의 회의일수는 정기회와 임시회를 합하여 연 30일을 초과하지 아니한다.
제20조(의안의 제출·발의)
운영위원회에서 심의할 안건은 학교장 또는 재적위원 3분의 1이상의 연서로 제출하거나 발의한다. 다만, 예산안과 결산은 학교장이 이를 제출한다.

제21조(의사 및 의결정족수)
운영위원회는 재적위원 과반수의 출석으로 개의하며, 출석위원 과반수의 찬성으로 의결한다.

제22조(전문가 등의 의견청취)
01학교장이 제출한 안건을 심의할 때에는 학교장은 교직원중 관계자를 운영위원회에 출석시켜 이를 설명하고 위원의 질의에 답변케 할 수 있다.
02위원이 아닌 교감은 운영위원회에 출석하여 발언할 수 있다.
03운영위원회는 필요한 경우 전문가·학생대표·교육청 및 일반행정기관의 장 등의 의견을 들을 수 있다.
제23조(회의의 공개 등)
01운영위원회의 회의는 공개함을 원칙으로 한다. 다만, 학생교육 또는 교원의 보호 등을 위하여 필요하다고 인정하는 경우에는 운영위원회의 결정으로 공개하지 아니할 수 있다.
02운영위원회가 회의를 개최할 때에는 가정통신문, 학교 게시판 등을 통하여 회의 개최일자, 안건 등을 알림으로써 일반학부모, 교사 등이 회의에 참관할 수 있도록 하여야 한다.
03위원장은 질서를 유지하기 위하여 방청인의 퇴장을 명할 수 있다.
제24조(회의록 작성 등)
01운영위원회는 회의록을 작성하고, 출석위원의 성명을 기재한 후 위원장과 학교장이 서명한다.
02위원장은 회의록을 학교에 비치하여 학부모, 교원에게 열람할 수 있도록 한다. 다만, 운영위원회에서 비공개하기로 결정한 사항은 공개되는 회의록에 이를 게재하지 아니할 수 있다.
03운영위원회는 매 학년도 말에 예·결산 내역을 포함한 운영위원회의 활동상황보고서를 작성하여 학부모·교원 및 관할 교육청에 배포하고 차기 정기회의시 이를 보고하여야 한다.
제25조(간사 등)
운영위원회의 회의기록 등 사무를 처리하기 위하여 행정실장을 간사를 두며, 학사활동과 관련된 사무에 대하여는 해당부가 협조한다.

제5장 학교발전기금의 조성·운용
제26조(학교발전기금의 조성·운영)
01운영위원회는 학교발전기금을 조성할 수 있다. 이 경우 운영위원회는 운영위원회 위원장의 명의로 조성·운용하여야 한다.
02학교발전기금의 조성방법은 다음 각 호와 같다.
1. 기부자가 기부한 금품의 접수
2. 학부모 등으로 구성된 학교 내·외의 조직·단체 등이 그 구성원으로부터 자발적으로 갹출하거나 구성원외의 자로부터 모금한 금품의 접수
03학교발전기금의 사용목적은 다음 각호와 같다.
1. 학교교육시설의 보수 및 확충
2. 교육용 기자재 및 도서의 구입
3. 학교체육활동 기타 학예활동의 지원
4. 학생복지 및 학생자치활동의 지원
제27조(학교발전기금에 관한 업무 위탁 등)
01운영위원회는 발전기금의 관리 및 집행과 그 부수된 업무의 일부를 학교장에게 위탁한다.
02제1항의 규정에 의하여 업무를 위탁받은 학교장은 발전기금을 별도 회계를 통하여 관리하고 매 분기마다 발전기금의 집행계획 및 집행내역을 운영위원회에 서면으로 보고하여야 한다.
03운영위원회는 제2항의 규정에 의한 보고를 받은 경우에는 이를 검토하여 그 결과를 학부모에게 통지하여야 한다.
04운영위원회 제1항의 규정에 의하여 발전기금에 관한 업무를 당해 학교의 장에게 위탁한 경우에는 발전기금의 집행사항 등에 관하여 감사할 수 있다.
제28조(학교발전기금의 결산 통지 등)
운영위원회는 학교의 회계연도 종료 후 20일 이내에 결산을 완료하여 그 결과를 학부모에게 통지하고, 관할청에 보고하여야 한다.

제6장 심의 사항의 시행의무
제29조(시행의무 등)
01학교장은 운영위원회의 심의결과를 최대한 존중하여야 하며, 그 심의 결과와 다르게 시행하고자 하는 경우에는 이를 운영위원회와 관할청에 서면 보고하여야 한다.
02학교장은 운영위원회의 심의를 거치는 경우 교육활동 및 학교운영에 중대한 차질이 발생할 우려가 있거나 천재·지변 기타 불가항력의 사유로 운영위원회를 소집할 여유가 없는 때에는 제15조제1항의 사항에 대하여 운영위원회의 심의를 거치지 아니하고 이를 시행 할 수 있다.
03학교장은 제2항의 규정에 의하여 운영위원회의 심의를 거치지 아니하고 시행한 때에는 관련 사항과 그 사유를 지체없이 운영위원회와 관할청에 서면으로 보고하여야 한다.
제7장 운영경비 등
제30조(운영경비 등)
01위원의 연수시 교통비, 회의운영에 필요한 경비는 예산의 범위 내에서 실비를 지급할 수 있다.
02제1항의 경비는 학교운영지원비 등에 편성하여 지원한다.
제31조(운영세칙)
이 규정에 규정한 것 외에는 운영위원회의 운영에 관하여 필요한 사항은 운영위원의 의결을 거쳐 운영위원회의 위원장이 이를 결정한다.

제8장 규정의 개정
제32조(개정의 제안)
운영위원회규정개정은 재적위원 2분의 1이상 또는 학교장의 발의로 제안된다.

제33조(규정의 개정)
운영위원규정은 재적위원 3분의 1이상의 찬성으로 개정되며 위원장은 즉시 이를 공포하여야 한다.

부칙(2000. 3. 28)
01(시행일) 이 규정은 공포한 날부터 시행한다.
02(학교운영위원회 위원에 대한 경과조치) 이 규정은 시행당시 선출된 학교운영위원회 위원은 이 규정에 의하여 선출된 것으로 보며, 차기 운영위원회위원 임기개시일 전일에 만료된다. 또한 학교운영위원회 위원 임기개시일 전에 심의된 사항은 임기개시일 후에 심의된 것으로 한다.
부칙(2001. 4. 7.)
제1조 이 규정은 공포한 날로부터 시행한다.

부칙(2002. 2. 25)
제1조(시행일) 이 규정은 공포한 날로부터 시행하되, 제2조 1항의 개정조항은 2002년 4월 1일부터 시행한다.

부칙(2003. 3. 31)
제1조(시행일) 이 규정은 공포한 날로부터 시행한다.

부칙(2004. 6. 4.)
제1조(시행일) 이 규정은 공포한 날로부터 시행한다.

부칙(2007. 2. 12)
제1조(시행일) 이 규정은 공포한 날로부터 시행한다.

부칙(2008. 2. 14)
제1조(시행일) 이 규정은 공포한 날로부터 시행한다.

부칙(2015. 7. 16)
제1조(시행일) 이 규정은 공포한 날부터 시행한다.
제2조(위원장 및 부위원장 임기에 관한 적용례) 제12조 제2항의 개정규정은 이 규정 시행 후 위원장 및 부위원장으로 당선되는 사람부터 적용한다.
부칙(2020. 3. 5.)
제1조(시행일) 이 규정은 공포한 날부터 시행한다.

방학 언제 끝나냐(8월 18일에 개학)
8월 일정(25일 가정폭력예방교육, 27일 학습전략진로캠프(2학년, 6h, 진로))
9월 일절(1일 도박예방교육, 2일 영어듣기(1학년), 3일 영어듣기(2학년), 4일 영어듣기(3학년), 8일 성폭력예방교육, 10일 학부모교육(14시), 15일 학교가꾸기, 16일 목요일수업, 22일 수업나눔, 29일 2학년중간고사, 30일 2학년중간고사)
10월 일정(1일 1학년 온종일예술체움 2,3학년 현장체험학습 환경정화활동, 3일 개천절, 6~9일 추석, 10일 재량휴업일, 13일 학교가꾸기, 15일 학부모교육(14시), 20일 마약및약물오남용예방교육, 22일 달성국악한마당(1학년 교과), 27일 수업나눔, 28일 3학년기말고사,지역연계인성교육체험학습(1학년,도동서원), 29일 3학년 기말고사, 30일 3학년 기말고사)
11월 일정(1일 금요일수업, 7일 1학년진로비전디자인캠프4h 2,3학년동아리(1-4), 10일 장애이해교육, 12일 고교컨설팅캠프(3학년, 4h.교과), 17일 아동학대예방교육, 24일 수업나눔)
12월 일정(1일 수업나눔, 2일 2학년기말고사, 3일 2학년기말고사 창의융합체험활동 (3학년 교과), 4일 2학년기말고사, 5일 동아리(5,6)1학년 직업체험캠프 2h, 24일 화원예술제(동5), 25일 성탄절, 31일 방학식 학교폭력예방교육 안전교육)
2월 일절(2일 개학, 5월 종업/졸업식(자2))

급식기능은 아직 구현안됨.
`;

// '/chat' 엔드포인트로 POST 요청이 오면 처리합니다.
app.post('/chat', async (req, res) => {
    try {
        const userMessage = req.body.message;

        // 특정 질문에 대해 직접 응답
        if (userMessage.includes('사이트') || userMessage.includes('홈페이지') || userMessage.includes('주소')) {
            return res.json({ reply: '[화원중학교 홈페이지](https://hw.dge.ms.kr/hwm/main.do)' });
        }

        // 학사일정 관련 질문에 대해 이미지 경로 반환
        const haksaRegex = /학사\s*일정|학교\s*일정|스케줄|일정/i;
        if (haksaRegex.test(userMessage)) {
            return res.json({
                reply: `
                다음은 화원중학교의 학사일정입니다:
                <img src="/haksa/haksa1.png" style="max-width:100%; display:block; margin-bottom:8px;">
                <img src="/haksa/haksa2.png" style="max-width:100%; display:block;">
` });
        }

        const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });

        // Gemini에게 역할을 부여하고, 기본 정보를 제공하며, 사용자의 질문에 답변하도록 프롬프트를 구성합니다.
        const prompt = `
당신은 화원중학교의 모든 것을 알고 있는 친절한 AI 챗봇입니다.
아래 제공된 정보를 바탕으로 학생이나 학부모의 질문에 답변해주세요.
정보에 없는 내용이라면 "해당 정보는 제가 알지 못하는 내용이에요. 학교 행정실에 문의해보시는 건 어떨까요?" 라고 부드럽게 안내해주세요.
답변은 항상 한국어로, 완전한 문장으로 친절하게 해주세요.

--- 화원중학교 정보 ---
${hwawonInfo}
--------------------

사용자 질문: ${userMessage}
챗봇 답변:
        `;

        const result = await model.generateContent(prompt);
        const response = await result.response;
        const text = response.text();

        res.json({ reply: text });

    } catch (error) {
        console.error("Error processing chat:", error);
        res.status(500).json({ error: '챗봇 응답 생성에 실패했습니다.' });
    }
});

app.listen(port, () => {
    console.log(`서버가 http://localhost:${port} 에서 실행 중입니다.`);
});

